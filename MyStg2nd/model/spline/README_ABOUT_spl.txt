＜スプライン定義ファイルの仕様について＞

スプライン定義ファイルとは、拡張子がsplで以下のようなフォーマットのファイルの事です
プログラムで読み込まれ、キャラの動きに使用されます。

sample.spl -------------------------------------
[SPLINE]
samplebase.dat

[MAGNIFICATION]
4000000.0 1125000.0 4000000.0

[CLASS]
FixedFrameSpline 520 6000
------------------------------------------------

＜説明＞
[SPLINE]
スプライン曲線の基点座標情報のファイルを指定します（後述）

[MAGNIFICATION]
上記の基点座標情報に倍率を掛けることができます。
フォーマットは X軸方向 Y軸方向 Z軸方向 の順です。
例では元の座標情報を X軸方向に4000000.0倍、Y軸方向に1125000.0、
Z軸方向に4000000.0 したものをスプライン曲線のポイントとするという意味です。
拡大縮小が不要な場合は

1.0 1.0 1.0

と記述すればOKです。

[CLASS]
スプラインクラスを指定します。キャラがどのようにスプライン曲線上を
移動するかに影響します。
構文は今のところ

FixedFrameSpline <spent_frame> <angveloRzRyMv>
又は
FixedVelocitySpline <angveloRzRyMv>

以上の２種類のみです。

【FixedFrameSpline <spent_frame> <angveloRzRyMv> の場合】
FixedFrameSpline ・・・ スプラインの開始点～終了点の移動を、時間(フレーム)固定で移動させる。
<spent_frame>    ・・・ 移動完了に費やすフレーム数
<angveloRzRyMv>  ・・・ 毎フレーム方向転換可能な最大角(1000 で 1度）
です、補足として
各キャラが保持している移動速度は無視されます。
スプライン曲線の点の個数と費やすフレーム数から計算された移動速度が逐一キャラの速度値に上書き設定されます。
このため、スプライン曲線の点の密度が濃いところはスピードが遅く、点の密度が薄いところはスピードが速い移動となります。

【FixedVelocitySpline <angveloRzRyMv> の場合】
FixedVelocitySpline ・・・ スプラインの開始点～終了点の移動を、速度固定で移動させる。
<angveloRzRyMv>     ・・・ 毎フレーム方向転換可能な最大角(1000 で 1度）
です、補足として
各キャラが保持している移動速度がずっと使用されます。
スプライン曲線の点の密度がスピードに影響しません。




＜スプライン曲線の基点座標情報のファイル＞
スプライン定義ファイル(*.spl) の [SPLINE] 項目に指定したファイルは
以下のようなフォーマットのスプライン曲線の基点情報ファイルです。

samplebase.dat ---------------------------------
[BASEPOINT]
#       X         Y         Z
-1.724577  0.000000  0.000000
-0.964337 -0.088378 -0.344892
-0.501305 -0.055518 -0.298879
-0.179336 -0.031628 -0.240141
 0.123544 -0.016126 -0.165195
 0.362343  0.000000  0.000000
 0.545634  0.038709  0.176104
 0.704048  0.173192  0.372772
 0.864812  0.444651  0.516556
 1.055714  0.626849  0.569336
 1.246407  0.655359  0.547772
 1.365876  0.590994  0.453279
 1.388259  0.465998  0.332581
 1.362117  0.328636  0.211183
 1.242692  0.226675  0.087900
 1.064405  0.202917  0.000000
 0.920421  0.202917  0.000000

[ACCURACY]
0.2
-------------------------------------------------


以下解説。

[BASEPOINT]
スプライン曲線上の基点を X Y Z で設定。
指定できるポイント数は最大1000個まで
自機の移動範囲を -1.0 ～ 1.0 として設定する。
但し、このスプライン座標は、絶対座標として移動を行うキャラも居るし、
始点をキャラの現時点の座標とおき、基点は相対座標として移動するキャラも居る、
それらの設定は各キャラのプログラムに組み込まれており、ココでの指定は不可。

[ACCURACY]
スプライン曲線座標点の精度。
BASEPOINTで指定した基点～基点の間にどのくらいの補完点を追加して、折れ線をなめらかな曲線に近づけるかという割合。
1.0  を指定すると基点～基点の間に補完点は挿入されず、BASEPOINT指定通りのままとなる。
0.5  を指定すると各基点～基点について、2分割される点に補完点が計算されて挿入される。(つまり基点～基点に、補完点は1個づつ挿入される)
0.25 を指定すると各基点～基点について、4分割される点に補完点が計算されて挿入される。(補完点は3個挿入される)
0.1  を指定すると各基点～基点について、10分割される点に補完点が計算されて挿入される。(補完点は9個挿入される)
0.01 を指定すると各基点～基点について、100分割される点に補完点が計算されて挿入される。(補完点は99個挿入される)
といった具合。


2010/12/15 by Gecchi
2011/08/09 [SPLINE] [MAGNIFICATION] 追加による改定
